(function(){function t(e){this.options=E(this,e),this.options.apiroot||(this.options.apiroot="https://api.cloudmine.me");var t=this.options.appid;e.savelogin&&(this.options.email||(this.options.email=T("email",t)),this.options.username||(this.options.username=T("username",t)),this.options.session_token||(this.options.session_token=T("session_token",t))),this.options.user_token=T("ut",t)||N("ut",this.keygen(),t)}function n(t){this.config=z({},o,t),this._events={};var i="JS/"+e,s=this.config.options;s.appname&&(i+=" "+s.appname.replace(y,"_"),s.appversion&&(i+="/"+s.appversion.replace(y,"_"))),this.additionalData=this.config.callbackData,this.data=null,this.hasErrors=!1,this.requestData=this.config.data,this.requestHeaders={"X-CloudMine-ApiKey":s.apikey,"X-CloudMine-Agent":i,"X-CloudMine-UT":s.user_token},this.responseHeaders={},this.responseText=null,this.status=null,this.type=this.config.type||"GET";var u=R(C(s,this.config.query)),a="/",l=s.session_token,c=s.applevel;if(c===!1||c!==!0&&l!=null)t.action.split("/")[0]!=="account"&&(a="/user/"),l!=null&&(this.requestHeaders["X-CloudMine-SessionToken"]=l);for(var h in this.config.headers)M(this.requestHeaders,h,this.config.headers[h]);this.config.headers=this.requestHeaders,q(r)||(this.config.headers["X-CloudMine-UT"]+=";"+R(r,":",",",null,f),r={}),this.setContentType(t.contentType||"application/json"),this.url=[this.config.options.apiroot,"/v1/app/",this.config.options.appid,a,this.config.action].join("");var p=this.url.indexOf("?")===-1?"?":"&";this.url=[this.url,u?p+u:""].join("");var d=this,v=this.config,m=+(new Date);this.config.complete=function(e,t){var i;if(e){i=e.responseText,d.status=e.status,d.responseText=i,d.responseHeaders=U(e.getAllResponseHeaders(),/:\s*/,/(?:\r|\n)?\n/);var s=M(d.responseHeaders,"X-Request-Id");s&&(r[s]=+(new Date)-m);try{d.data=JSON.parse(i||"{}")}catch(o){d.data=i}}else d.status="abort",d.data=[v.data];t=="success"&&d.status>=200&&d.status<300?i=v.processResponse.call(d,d.data,e,d):(i={errors:{}},D(d.data)&&(d.data={errors:[d.data]}),i.errors[d.status]=d.data),setTimeout(function(){n.complete(d,i)},1)},!this.config.later&&this.config.async&&setTimeout(function(){d.config.cancel||(d.xhr=G(d.url,v))},1)}function i(e,t){t=t||{},this.status=400,this.responseText=[],this._headers={};var n=et.parse(e);n.agent=!1,n.method=t.type,n.headers=t.headers||{},_(t.data)&&t.processData&&(t.data=JSON.stringify(t.data));if(t.username||t.password)n.headers.Authorization="Basic "+K(t.username+":"+t.password);t.data=t.data||"",B(t.data)?n.headers["content-length"]=v.byteLength(t.data):D(t.data)&&(n.headers["content-length"]=v.byteLength(t.data));var r=this,i=t.context||this;this._textStatus="success",this._request=(n.protocol==="http:"?J:Q).request(n,function(e){e.setEncoding(t.encoding||"utf8"),e.on("data",function(e){r.responseText.push(e)}),e.on("end",function(){r._headers=R(e.headers,": ","\n",!0)||"",r.status=e.statusCode;var n;try{n=r.responseText=r.responseText.join("");if(t.dataType=="json"||t.dataType!="text"&&e.headers["content-type"].match(/\bapplication\/json\b/i))n=JSON.parse(n)}catch(s){r._textStatus="parsererror"}r._textStatus=="success"&&r.status>=200&&r.status<300?t.success&&t.success.call(i,n,"success",r):t.error&&t.error.call(i,r,"error",r.responseText),t.complete&&t.complete.call(i,r,r._textStatus)})}),this._request.on("error",function(e){r.status=e.status,r.responseText=e.message,r._textStatus="error",t.error&&t.error.call(i,r,"error",e.message),t.complete&&t.complete.call(i,r,"error")}),this._request.end(t.data)}function b(){return Math.round(Math.random()*15).toString(16)}function w(){var e=Array(32),t;e[14]=4,e[19]=(Math.round(Math.random()*16)&3|8).toString(16);for(t=0;t<14;++t)e[t]=b();for(t=15;t<19;++t)e[t]=b();for(t=20;t<32;++t)e[t]=b();return e.join("")}function E(e,t){return t&&t.userid&&!t.email&&(t.email=t.userid),z({},e.options,t)}function T(e,t){var n=tt(t);return n[e]}function N(e,t,n){var r=tt(n);return r[e]!=t&&(r[e]=t,nt(n)),t}function C(e,t){var n,r;t==null&&(t={});for(n in s)r=s[n],e[n]!=null&&(t[r]=e[n]);return t}function k(e,t,n){return O(e,function(e){return(!t||e[0]==t)&&(!n||n==e[1])})}function L(e,t,n){return Array.prototype.slice.call(e,t||0,n||e.length)}function A(e,t,n){n=n||this;if(B(e))if(e.forEach)e.forEach(t,n);else for(var r=0;r<e.length;++r){var i=e[r];i!=null&&t.call(n,i,s,n)}else if(_(e))for(var s in e){var i=e[s];i!=null&&t.call(n,i,s,n)}}function O(e,t,n){var r=null;return n=n||this,B(e)?e.filter?r=e.filter(t,n):(r=[],A(e,function(e,n,i){t.apply(this,arguments)&&r.push(e)})):(r={},A(e,function(e,n,i){t.apply(this,arguments)&&(r[n]=e)})),r}function M(e,t,n){if(e[t]==null){var r=t.toLowerCase();for(var i in e)if(i.toLowerCase()===r){t=i;break}}return n!==undefined&&(e[t]=n),e[t]}function _(e){return e&&typeof e=="object"}function D(e){return typeof e=="string"}function P(e){return typeof e=="number"&&!isNaN(e)}function H(e){return _(e)&&g.indexOf(e.constructor)>-1}function B(e){return e===null?!1:_(e)&&e.length!=null}function j(e){return typeof e=="function"}function F(e){return _(e)&&e.__type__==="geopoint"}function I(e,t){if(P(e)&&P(t))return{latitude:t,longitude:e};if(_(e)){if(t&&F(e[t]))return I(e[t]);var n={latitude:e.latitude||e.lat||e.y,longitude:e.longitude||e.lng||e.x};if(P(n.latitude)&&P(n.longitude))return n;for(var r in e)if(F(e[r]))return{latitude:e.latitude||e.lat||e.y,longitude:e.longitude||e.lng||e.x}}return null}function q(e){if(e){if(e%1===0)return!1;for(var t in e)if(e.hasOwnProperty(t))return!1}return!0}function R(e,t,n,r,i){t=t||"=",i=i==undefined?-1:i;var s=[],o,u=r?V:encodeURIComponent,a=0;for(var f in e){e[f]!=null&&!j(e[f])&&(B(e[f])?e[f].forEach(function(e){s.push(u(f)+t+u(e))}):(o=_(e[f])?JSON.stringify(e[f]):e[f],s.push(u(f)+t+u(o)))),a++;if(a===i)break}return s.join(n||"&")}function U(e,t,n,r){var i={};if(D(e)){e=e.split(n||"&");var s=r?V:decodeURIComponent;for(var o=0;o<e.length;++o){var u=e[o].split(t);i[s(u.shift())]=s(u.join(t))}}else i=e;return i}function z(e){for(var t=1;t<arguments.length;++t)A(arguments[t],function(t,n,r){t!=null&&(e[n]=t)});return e}function W(e){if(_(e)){var t=[];for(var n in e)t.push(n+" = "+JSON.stringify(e[n]));return"["+t.join(", ")+"]"}return e}function X(){throw new Error("Unsupported operation")}function V(e){return e}var e="0.9.14";t.prototype={api:function(e,t,r){t=E(this,t);var i=t.method||"GET",s={action:e,type:i,options:t};return t.query&&(s.query=t.query,delete s.options.query),r!==undefined&&(s.data=JSON.stringify(r)),new n(s)},get:function(e,t){B(e)?e=e.join(","):_(e)&&(t=e,e=null),t=E(this,t);var r=e?C(t,{keys:e}):null;return new n({action:"text",type:"GET",options:t,query:r})},update:function(e,t,r){if(_(e))r=t;else{e||(e=this.keygen());var i={};i[e]=t,e=i}return r=E(this,r),new n({action:"text",type:"POST",options:r,query:C(r),data:JSON.stringify(e)})},set:function(e,t,r){if(_(e))r=t;else{e||(e=this.keygen());var i={};i[e]=t,e=i}return r=E(this,r),new n({action:"text",type:"PUT",options:r,query:C(r),data:JSON.stringify(e)})},destroy:function(e,t){t=E(this,t);var r={};return e==null&&t.all===!0?r={all:!0}:t.query?(r={q:W(t.query)},delete t.query):r={keys:B(e)?e.join(","):e},new n({action:"data",type:"DELETE",options:t,query:C(t,r)})},run:function(e,t,r){r=E(this,r),t=z({},r.params,t),r.params=null,r.snippet=null;var i={action:"run/"+e,type:r.method||"GET",options:r};return i.type==="GET"?i.query=t:i.data=JSON.stringify(t),new n(i)},search:function(e,t){t=E(this,t),e={q:e!=null?W(e):""};var r=undefined;return t.method==="POST"&&(r=JSON.stringify(e),e={}),new n({action:"search",type:t.method||"GET",query:C(t,e),data:r,options:t})},searchFiles:function(e,t){e=W(e);var n='[__type__ = "file"';return!e||e.replace(/\s+/,"").length==0?n+="]":e[0]!="["?n+="]."+e:n+=(e[1]=="]"?"":", ")+e.substring(1),this.search(n,t)},searchUsers:function(e,t){return e={p:e!=null?W(e):""},t=E(this,t),new n({action:"account/search",type:"GET",query:C(t,e),options:t})},allUsers:function(e){return e=E(this,e),new n({action:"account",type:"GET",query:C(e),options:e})},pushNotification:function(e,t){return t=E(this,t),new n({action:"push",type:"POST",query:C(t),options:t,data:JSON.stringify(e)})},getUser:function(e,t){return t=E(this,t),new n({action:"account/"+e,type:"GET",query:C(t),options:t})},searchGeo:function(e,t,n,r){var i,r;_(t)?(r=n||{},i=I(t,e)):(r||(r={}),i=I(t,n));if(!i)throw new TypeError("Parameters given do not provide geolocation data");var s=r.radius;P(s)?s=", "+s+(r&&r.units?r.units:"km"):D(s)&&s.length?(s=", "+s,r.units||(r.units=s.match(/mi?|km|ft/)[0])):s="";var o=(e||"location")+" near ("+i.longitude+", "+i.latitude+")"+s;return this.search("["+o+"]",r)},upload:function(e,t,r){function s(e,t){r.contentType||(r.contentType=t||c),n.binaryUpload(i,e,r.filename,r.contentType).done()}r=E(this,r),e||(e=this.keygen()),r.filename||(r.filename=e);var i=new n({action:"binary/"+e,type:"post",later:!0,encoding:"binary",options:r,processResponse:n.basicResponse});if(D(t)||v&&t instanceof v)Y?(D(t)&&(t=Z.readFileSync(t)),s(t)):X();else if(t.toDataURL)s(t,"image/png");else if(m&&t instanceof m)s(t.canvas,"image/png");else if(H(t)){var o=new p;o.onabort=function(){i.setData("FileReader aborted").abort()},o.onerror=function(e){i.setData(e.target.error).abort()},o.onload=function(e){s(e.target.result)},h&&t instanceof h?!r.contentType&&t.type!=""&&(r.contentType=t.type):t=new Blob([new Uint8Array(t)],{type:r.contentType||c}),o.readAsDataURL(t)}else X();return i},download:function(e,t){t=E(this,t);var r={success:{}},i;t.filename&&(i={force_download:!0,apikey:t.apikey,session_token:t.session_token,filename:t.filename});var s=new n({action:"binary/"+e,type:"GET",later:!0,encoding:"binary",options:t,query:i});if(t.filename){if(Y)s.setProcessor(function(n){return r.success[e]=Z.writeFileSync(t.filename,n,"binary"),r}).done();else{function o(){u.parentNode&&document.body.removeChild(u)}var u=document.createElement("iframe");u.style.display="none",document.body.appendChild(u),setTimeout(function(){u.src=s.url},25),u.onload=function(){clearTimeout(o.timer),o.timer=setTimeout(o,5e3)},o.timer=setTimeout(o,6e4),r.success[e]=u}s.done(r)}else t.mode==="buffer"&&(d||v)?s.setProcessor(function(t){var n;if(v)n=new v(t,"binary");else{n=new d(t.length);var i=new Uint8Array(n);for(var s=0;s<t.length;++s)i[s]=t[s]&255}return r.success[e]=n,r}).done():s.setProcessor(function(t){return r.success[e]=t,r}).done();return s},createUser:function(e,t,r){_(e)?r=t:e={email:e,password:t},r=E(this,r),r.applevel=!0;var i=JSON.stringify({credentials:{email:e.email,username:e.username,password:e.password},profile:r.profile});return new n({action:"account/create",type:"POST",options:r,processResponse:n.basicResponse,data:i})},updateUser:function(e,t,r){if(_(e))r=t;else{var i={};i[e]=t,e=i}return r=E(this,r),new n({action:"account",type:"POST",options:r,query:C(r),data:JSON.stringify(e)})},updateUserMaster:function(e,t,r){return r=E(this,r),new n({action:"account/"+e,type:"POST",options:r,query:C(r),data:JSON.stringify(t)})},changePassword:function(e,t,r,i){_(e)?i=t:e={email:e,oldpassword:t,password:r},i=E(this,i),i.applevel=!0;var s=JSON.stringify({email:e.email,username:e.username,password:e.oldpassword,credentials:{password:e.password}});return new n({action:"account/password/change",type:"POST",data:s,options:i,processResponse:n.basicResponse})},changeCredentials:function(e,t){t=E(this,t),t.applevel=!0;var r=JSON.stringify({email:e.email,username:e.username,password:e.password,credentials:{password:e.new_password,username:e.new_username,email:e.new_email}});return new n({action:"account/credentials",type:"POST",data:r,options:t,processResponse:n.basicResponse})},resetPassword:function(e,t){t=E(this,t),t.applevel=!0;var r=JSON.stringify({email:e});return new n({action:"account/password/reset",type:"POST",options:t,processResponse:n.basicResponse,data:r})},confirmReset:function(e,t,r){r=E(this,r),r.applevel=!0;var i=JSON.stringify({password:t});return new n({action:"account/password/reset/"+e,type:"POST",data:i,processResponse:n.basicResponse,options:r})},login:function(e,t,r){_(e)?r=t:e={email:e,password:t},r=E(this,r),r.applevel=!0,this.options.email=null,this.options.username=null,this.options.session_token=null,r.savelogin&&(N("email",null,this.options.appid),N("username",null,this.options.appid),N("session_token",null,this.options.appid));var i=JSON.stringify({username:e.username,email:e.email,password:e.password}),s=this;return(new n({action:"account/login",type:"POST",options:r,data:i,processResponse:n.basicResponse})).on("success",function(t){r.savelogin&&(N("email",e.email,s.options.appid),N("username",e.username,s.options.appid),N("session_token",t.session_token,s.options.appid)),s.options.email=e.email,s.options.username=e.username,s.options.session_token=t.session_token})},loginSocial:function(e,t){function l(){f.closed&&(clearTimeout(l.interval),s.done())}Y&&X(),t=E(this,t),t.applevel=!0;var r=w(),i=this,s=new n({action:"account/social/login/status/"+r,options:t,later:!0,processResponse:function(e){return e.finished?(i.options.session_token=e.session_token,i.options.userid=e.profile.__id__,e={success:e}):(i.options.session_token=null,i.options.userid=null,e={errors:["Login unsuccessful."]}),t.savelogin&&(N("session_token",e.success.session_token,i.options.appid),N("userid",e.success.profile.__id__,i.options.appid)),e}}),o=this.options.apiroot+"/v1/app/"+t.appid+"/account/social/login",u={service:e,apikey:t.apikey,challenge:r};this.options.session_token&&t.link!==!1&&(u.session_token=this.options.session_token),t.scope&&(u.scope=t.scope);var a=o.indexOf("?")===-1?"?":"&";o=o+a+R(u);var f=window.open(o,r,"width=600,height=400,menubar=0,location=0,toolbar=0,status=0");return l.interval=setInterval(l,50),s},socialQuery:function(e,t){t=E(this,t);if(!t.session_token)throw new Error("Must be logged in to perform a social query");if(e.headers&&!_(e.headers))throw new Error("Headers must be an object");if(e.params&&!_(e.params))throw new Error("Extra parameters must be an object");var r="social/"+e.network+"/"+e.endpoint,i={};e.headers&&(i.headers=e.headers),e.params&&(i.params=e.params);var s=new n({action:r,type:e.method,query:i,options:t,data:e.data,contentType:"application/octet-stream"});return s},logout:function(e){e=E(this,e),e.applevel=!0;var t=this.options.session_token;return this.options.email=null,this.options.username=null,this.options.session_token=null,e.savelogin&&(N("email",null,this.options.appid),N("username",null,this.options.appid),N("session_token",this.options.appid)),new n({action:"account/logout",type:"POST",processResponse:n.basicResponse,headers:{"X-CloudMine-SessionToken":t},options:e})},verify:function(e,t,r){return _(e)?E=t:e={email:e,password:t},r=E(this,r),r.applevel=!0,new n({action:"account/login",type:"POST",processResponse:n.basicResponse,data:JSON.stringify(e),options:r})},deleteUser:function(e,t,r){_(e)?r=t:e={email:e,password:t},r=E(this,r),r.applevel=!0;var i={action:"account",type:"DELETE",options:r,processResponse:n.basicResponse};return e.email==this.options.email&&(this.options.session_token=null,this.options.email=null,r.savelogin&&(N("email",null,this.options.appid),N("username",null,this.options.appid),N("session_token",null,this.options.appid))),e.password?i.data=JSON.stringify({email:e.email,username:e.username,password:e.password}):i.action+="/"+e.email,new n(i)},updateACL:function(e,t){return t=E(this,t),new n({action:"access",type:"PUT",processResponse:n.basicResponse,data:JSON.stringify(e),options:t})},getACL:function(e,t){return t=E(this,t),new n({action:"access/"+e,type:"GET",processResponse:n.basicResponse,options:t})},isLoggedIn:function(){return!!this.options.session_token},getUserID:function(){return this.options.email},getSessionToken:function(){return this.options.session_token},getEmail:function(){return this.options.email},getUsername:function(){return this.options.username},getOption:function(e){return s[e]?this.options[e]:null},setOption:function(e,t){return s[e]?(this.options[e]=t,!0):!1},useApplicationData:function(e){this.options.applevel=e===!0||e===!1?e:undefined},isApplicationData:function(){return this.options.applevel===!0||this.options.applevel===!1?this.options.applevel:this.options.session_token==null},keygen:w},t.VERSION=e,t.SocialNetworks=["bodymedia","dropbox","facebook","fitbit","flickr","foursquare","gcontacts","gdocs","github","gmail","google","gplus","instagram","linkedin","meetup","runkeeper","tumblr","twitter","withings","wordpress","yammer","zeo"],n.prototype={on:function(e,t,n){if(j(t)){n=n||this,this._events[e]||(this._events[e]=[]);var r=this;this._events[e].push([t,n,function(){r.off(e,t,n),t.apply(this,arguments)}])}return this},trigger:function(e){var t=this._events[e];if(t!=null){var n=L(arguments,1);A(t,function(e){e[2].apply(e[1],n)})}return this},off:function(e,t,n){return e==null&&t==null&&n==null?this._events={}:e==null?A(this._events,function(e,r,i){i._events[r]=k(e,t,n)}):this._events[e]=k(this._events[e],t,n),this},setContentType:function(e){return e=e||c,this.config&&(this.config.contentType=e,M(this.requestHeaders,"content-type",e),M(this.config.headers,"content-type",e)),this},abort:function(){return this.xhr?this.xhr.abort():this.config&&this.config.complete.call(this,this.xhr,"abort"),this.xhr&&(this.xhr=undefined,delete this.xhr),this.config&&(this.config=undefined,delete this.config),this},setData:function(e){return!this.xhr&&this.config&&(this.config.data=e),this},setProcessor:function(e){return!this.xhr&&this.config&&(this.config.processResponse=e),this},done:function(e){if(!this.xhr&&this.config)if(e){this.xhr=!0;var t=this;setTimeout(function(){n.complete(t,e)},1)}else this.xhr=G(this.url,this.config);return this},getHeader:function(e){return M(this.responseHeaders,e)}},n.complete=function(e,t){t.errors&&(e.hasErrors=!0),e.config&&(e.config=undefined,delete e.config),e.xhr&&(e.xhr=undefined,delete e.xhr),t.success&&(u[e.status]&&e.trigger(u[e.status],t.success,e,e.status),e.trigger(e.status,t.success,e,e.status),e.trigger("success",t.success,e)),t.meta&&e.trigger("meta",t.meta,e),t.result&&e.trigger("result",t.result,e);if(t.errors){for(var n in t.errors)u[n]&&e.trigger(u[n],t.errors[n],e,n),e.trigger(n,t.errors[n],e,n);e.trigger("error",t.errors,e)}e.trigger("complete",t,e)},n.textResponse=function(e,t,n){var r={};if(e.success||e.errors||e.meta||e.result){e.count!=null&&(n.count=e.count),q(e.success)||(r.success=e.success),q(e.meta)||(r.meta=e.meta),q(e.result)||(r.result=e.result);if(!q(e.errors)){r.errors={};for(var i in e.errors){var s=e.errors[i],o=400;s.code?(o=s.code,s=s.message||s):D(s)&&(o=a[s.toLowerCase()]||400),r.errors[o]||(r.errors[o]={}),r.errors[o][i]={errors:[s]}}}q(r)&&(this.config.options&&this.config.options.snippet?r.result={}:r.success={})}else r={success:e};return r},n.basicResponse=function(e,t,n){return{success:e||{}}},n.binaryUpload=function(e,t,n,r){var i=w();return v&&t instanceof v?(t=t.toString("base64"),r||(r=c)):(t.toDataURL&&(t=t.toDataURL(r)),t=t.replace(/^data:(.*?);?base64,/,""),r||(r=RegExp.$1||c)),e.setContentType("multipart/form-data; boundary="+i),e.setData(["--"+i,'Content-Disposition: form-data; name="file"; filename="'+n+'"',"Content-Type: "+r,"Content-Transfer-Encoding: base64","",t,"--"+i+"--"].join("\r\n"))};var r={};i.prototype={getResponseHeader:function(e){return this._headers[e]},getAllResponseHeaders:function(){return this._headers},abort:function(){this._request&&(this._textStatus="abort",this._request.abort(),this._request=undefined,delete this._request)}};var s={limit:"limit",sort:"sort",skip:"skip",snippet:"f",params:"params",dontwait:"async",resultsonly:"result_only",shared:"shared",shared_only:"shared_only",userid:"userid",count:"count",distance:"distance",units:"units"},o={async:!0,later:!1,processData:!1,dataType:"text",processResponse:n.textResponse,crossDomain:!0,cache:!1},u={200:"ok",201:"created",400:"badrequest",401:"unauthorized",404:"notfound",409:"conflict",500:"servererror"},a={"bad request":400,"permission denied":401,unauthorized:401,"key does not exist":404,"not found":404,conflict:409},f=20,l=this.window?window:root,c="application/octet-stream",h=l.File,p=l.FileReader,d=l.ArrayBuffer,v=l.Buffer,m=l.CanvasRenderingContext2D,g=[h,v,m,d,l.Uint8Array,l.Uint8ClampedArray,l.Uint16Array,l.Uint32Array,l.Int8Array,l.Int16Array,l.Int32Array,l.Float32Array,l.Float64Array],y=/[^a-zA-Z0-9._-]/g,S={},x="base",J,K,Q,G,Y,Z,et,tt,nt;if(!this.window)Y=!0,et=require("url"),J=require("http"),Q=require("https"),Z=require("fs"),module.exports={WebService:t},G=function(e,t){return new i(e,t)},K=function(e,t){return(new v(e,t||"utf8")).toString("base64")},tt=function(e){e="cm."+(e||x);if(!S[e]){var t=[".",process.env.HOME+"/."],n;while((n=t.shift())!=null)try{S[e]=JSON.parse(Z.readFileSync(n+e+".json","UTF8"));break}catch(r){}n||(S[e]={})}return S[e]},nt=function(e){e="cm."+(e||x);var t=[".",process.env.HOME+"/."],n;while((n=t.shift())!=null)try{Z.writeFileSync(n+e+".json",JSON.stringify(S[e]||{}),"UTF8");break}catch(r){}if(!n)throw new Error("Could not save CloudMine session data")};else{Y=!1,window.cloudmine=window.cloudmine||{},window.cloudmine.WebService=t,K=window.btoa;if(($=this.jQuery||this.Zepto)==null)throw new Error("Missing jQuery-compatible ajax implementation");G=$.ajax,$.support&&($.support.cors=!0),tt=function(e){e="cm."+(e||x);if(!S[e])try{S[e]=JSON.parse(localStorage.getItem(e))||{}}catch(t){S[e]={}}return S[e]},nt=function(e){e="cm."+(e||x),localStorage.setItem(e,JSON.stringify(S[e]||{}))}}})()